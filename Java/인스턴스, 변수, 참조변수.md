# 인스턴스, 변수, 참조변수

#java #인스턴스 #변수 #참조변수 #객체 #면접 #개념정리

**관련 개념:** [[Stack 메모리]] [[Heap 메모리]] [[가비지 컬렉션 (Garbage Collection)|가비지 컬렉션]] [[객체]]

---

## Topic (오늘의 주제)

Java에서 변수, 참조변수, 인스턴스의 차이점을 명확히 이해하고, 각각이 메모리의 어디에 저장되는지 파악한다.

---

### **Why (왜 사용하는가? 왜 중요한가?)**

- **실무**: 변수, 참조변수, 인스턴스의 차이를 모르면 메모리 관리와 가비지 컬렉션을 이해할 수 없습니다. 참조변수와 인스턴스를 혼동하면 메모리 누수나 예상치 못한 동작이 발생할 수 있으며, 디버깅 시 메모리 상태를 정확히 파악하기 어려워집니다.

- **구조적 의미**: 변수는 데이터를 저장하는 컨테이너이고, 참조변수는 객체의 주소를 저장하며, 인스턴스는 실제 객체 데이터입니다. 이 구분을 통해 Stack과 Heap의 역할을 명확히 이해할 수 있고, 메모리 할당과 해제 과정을 정확히 파악할 수 있습니다.

- **면접 의도**: Java의 메모리 모델에 대한 이해, 변수와 참조변수의 차이, 인스턴스와 객체의 관계, 그리고 Stack과 Heap에서의 저장 방식을 확인하려 합니다.

---

### **Core Concept (핵심 개념 정리)**

#### 개념 정의

**변수 (Variable)**: 데이터를 저장하는 메모리 공간의 이름입니다. 기본 타입 변수와 참조 타입 변수로 나뉩니다.

**참조변수 (Reference Variable)**: 객체의 주소(참조)를 저장하는 변수입니다. Stack 메모리에 저장되며, 실제 객체 인스턴스를 가리킵니다.

**인스턴스 (Instance)**: 클래스로부터 생성된 실제 객체입니다. Heap 메모리에 저장되며, 속성(필드)과 동작(메서드)을 가집니다.

#### 변수의 종류

**1. 기본 타입 변수 (Primitive Variable)**:
- 기본 타입의 값을 직접 저장
- Stack 메모리에 저장
- 예: `int`, `double`, `boolean`, `char` 등

**2. 참조 타입 변수 (Reference Variable)**:
- 객체의 주소(참조)를 저장
- Stack 메모리에 저장
- 예: 클래스 타입, 배열 타입, 인터페이스 타입

#### 메모리 관점에서의 관계

```java
int num = 10;              // 변수: 기본 타입 변수
Object obj = new Object();  // 참조변수: obj, 인스턴스: new Object()
```

**메모리 구조**:
```
Stack 메모리          Heap 메모리
┌─────────┐          ┌─────────────┐
│  num    │          │             │
│  (10)   │          │  Object     │
│         │          │  인스턴스    │
│  obj    │ ────────→│  (실제 데이터)│
│ (주소)  │          │             │
└─────────┘          └─────────────┘
```

#### 변수 vs 참조변수 vs 인스턴스 비교

| 구분 | 변수 (기본 타입) | 참조변수 | 인스턴스 |
|:---:|:---:|:---:|:---:|
| **정의** | 데이터를 저장하는 공간 | 객체 주소를 저장하는 변수 | 클래스로부터 생성된 객체 |
| **저장 위치** | Stack | Stack | Heap |
| **저장 내용** | 실제 값 (10, 3.14 등) | 객체의 주소 (참조) | 실제 객체 데이터 |
| **생성 방법** | `int num = 10;` | `Object obj;` | `new Object();` |
| **메모리 크기** | 타입에 따라 고정 (int: 4byte) | 주소 크기 (보통 4~8byte) | 객체에 따라 가변 |
| **할당/해제** | 메서드 종료 시 자동 | 메서드 종료 시 자동 | GC가 회수 |
| **예시** | `int age = 25;` | `String name;` | `new String("Hello");` |

#### 동작 방식

```
변수, 참조변수, 인스턴스의 생성과 사용:

1. 기본 타입 변수 생성
   int num = 10;
   → Stack에 10 저장
      ↓
2. 참조변수 선언
   Object obj;
   → Stack에 참조변수 공간만 생성 (null)
      ↓
3. 인스턴스 생성 및 할당
   obj = new Object();
   → Heap에 Object 인스턴스 생성
   → Stack의 obj에 Heap 주소 저장
      ↓
4. 참조를 통한 객체 사용
   obj.toString();
   → Stack의 obj가 가리키는 Heap의 인스턴스 사용
      ↓
5. 참조 끊김
   obj = null;
   → Stack의 obj는 null
   → Heap의 인스턴스는 GC 대상
```

#### 장점/단점

**변수 (기본 타입)의 장점**:
- 빠른 접근 속도 (Stack에 직접 저장)
- 메모리 효율적 (고정 크기)
- 간단한 연산 가능

**변수 (기본 타입)의 단점**:
- 객체지향의 이점 활용 불가
- 복잡한 데이터 구조 표현 어려움

**참조변수의 장점**:
- 객체지향 프로그래밍 지원
- 동적 메모리 할당 가능
- 복잡한 데이터 구조 표현 가능

**참조변수의 단점**:
- 간접 접근으로 인한 약간의 오버헤드
- null 참조 가능성 (NullPointerException)
- 메모리 관리 필요 (GC)

**인스턴스의 장점**:
- 실제 데이터와 동작을 포함
- 재사용 가능한 객체
- 캡슐화, 상속, 다형성 지원

**인스턴스의 단점**:
- Heap 할당으로 인한 오버헤드
- GC 관리 필요
- 메모리 사용량이 가변적

#### 필요 조건

- **변수**: 타입 선언 필요
- **참조변수**: 객체(클래스) 타입 선언 필요
- **인스턴스**: `new` 키워드와 생성자 필요

---

### **Interview Answer Version (면접 답변식 요약)**

변수는 데이터를 저장하는 메모리 공간이고, 참조변수는 객체의 주소를 저장하는 변수이며, 인스턴스는 클래스로부터 생성된 실제 객체입니다.

차이점은 저장 위치와 내용입니다. 기본 타입 변수는 Stack에 실제 값을 저장하고, 참조변수는 Stack에 객체의 주소를 저장하며, 인스턴스는 Heap에 실제 객체 데이터를 저장합니다.

핵심은 참조변수와 인스턴스의 관계입니다. 참조변수는 Stack에 있고 인스턴스를 가리키는 주소만 저장하며, 실제 객체 데이터는 Heap에 있습니다. 따라서 `Object obj = new Object();`에서 `obj`는 참조변수이고 `new Object()`는 인스턴스입니다.

---

### **Practical Tip (사용시 주의할 점 or 활용 예)**

#### 설정 시 반드시 고려해야 할 파라미터

- **변수 타입 선택**: 기본 타입 vs 참조 타입
- **null 체크**: 참조변수는 null일 수 있으므로 항상 체크
- **메모리 관리**: 인스턴스는 GC가 관리하지만, 참조를 적절히 끊어야 함

#### 흔히 발생하는 문제/오해

> [!warning] 흔한 오해
> 
> "참조변수에 객체가 저장된다"는 생각은 잘못되었습니다. 참조변수는 Stack에 있고 객체의 주소만 저장하며, 실제 객체 인스턴스는 Heap에 저장됩니다. 또한 "변수와 참조변수가 같다"는 오해도 있는데, 변수는 기본 타입과 참조 타입을 모두 포함하는 개념이고, 참조변수는 참조 타입 변수를 의미합니다.

#### 적용 사례

```java
// 기본 타입 변수
int age = 25;              // Stack에 25 저장
double price = 1000.0;    // Stack에 1000.0 저장

// 참조변수와 인스턴스
String name = new String("Java");  
// Stack: 참조변수 name (주소 저장)
// Heap: String 인스턴스 ("Java" 데이터)

// 참조변수만 선언 (인스턴스 없음)
Object obj;  // Stack에 참조변수만 생성, 값은 null

// 인스턴스 생성 및 할당
obj = new Object();  
// Heap에 Object 인스턴스 생성
// Stack의 obj에 Heap 주소 저장

// 여러 참조변수가 같은 인스턴스 참조
Object obj1 = new Object();
Object obj2 = obj1;  // obj2도 같은 인스턴스를 가리킴
```

#### 이걸 모르고 사용하면 생기는 문제

> [!error] 이걸 모르고 사용하면
> 
> - **NullPointerException**: 참조변수가 null인데 인스턴스 메서드 호출
> - **메모리 누수**: 참조를 끊지 않아 인스턴스가 GC되지 않음
> - **예상치 못한 동작**: 여러 참조변수가 같은 인스턴스를 참조할 때
> - **메모리 오해**: 참조변수에 객체가 저장된다고 착각
> - **변수와 참조변수 혼동**: 기본 타입과 참조 타입의 차이를 모름

---

### 예상 꼬리질문정리

#### 1. 변수와 참조변수의 차이는?

- **변수**: 데이터를 저장하는 메모리 공간 (기본 타입 + 참조 타입 모두 포함)
- **참조변수**: 참조 타입 변수로, 객체의 주소를 저장
- **관계**: 참조변수는 변수의 한 종류
- **예시**: 
  - 변수: `int num = 10;` (기본 타입 변수)
  - 참조변수: `String str = "Hello";` (참조 타입 변수)

#### 2. 참조변수와 인스턴스의 차이는?

- **참조변수**: Stack에 저장, 객체의 주소만 저장
- **인스턴스**: Heap에 저장, 실제 객체 데이터
- **관계**: 참조변수가 인스턴스를 가리킴
- **예시**: 
  ```java
  Object obj = new Object();
  // obj: 참조변수 (Stack)
  // new Object(): 인스턴스 (Heap)
  ```

#### 3. 객체와 인스턴스의 차이는?

- **객체**: 클래스로부터 생성된 실체 (일반적인 용어)
- **인스턴스**: 특정 클래스의 인스턴스 (구체적인 용어)
- **관계**: 거의 동일한 의미, "Object 클래스의 인스턴스"라고 구체화할 때 사용
- **예시**: `new Object()`는 Object 클래스의 인스턴스이자 객체

#### 4. 참조변수가 null이면 어떻게 되나?

- **null**: 참조변수가 아무 인스턴스도 가리키지 않음을 의미
- **문제**: null인 참조변수로 메서드 호출 시 NullPointerException 발생
- **해결**: null 체크 후 사용
  ```java
  Object obj = null;
  if (obj != null) {
      obj.toString();  // 안전한 사용
  }
  ```

#### 5. 여러 참조변수가 같은 인스턴스를 가리킬 수 있나?

- **가능**: 여러 참조변수가 같은 Heap의 인스턴스를 참조 가능
- **예시**:
  ```java
  Object obj1 = new Object();
  Object obj2 = obj1;  // 같은 인스턴스 참조
  ```
- **GC 관점**: 모든 참조가 끊어져야 GC 대상이 됨
- **주의**: 하나의 참조변수로 인스턴스를 수정하면 다른 참조변수에도 영향

#### 6. 기본 타입 변수와 참조변수의 메모리 차이는?

- **기본 타입 변수**: Stack에 실제 값 저장 (int: 4byte, double: 8byte)
- **참조변수**: Stack에 주소만 저장 (보통 4byte 또는 8byte)
- **인스턴스**: Heap에 실제 데이터 저장 (객체에 따라 가변)
- **예시**:
  ```java
  int num = 10;           // Stack에 10 (4byte) 저장
  String str = "Hello";   // Stack에 주소 (4~8byte), Heap에 "Hello" 데이터
  ```

---

## 관련 노트

- **[[Stack 메모리]]** - 변수와 참조변수가 저장되는 메모리 영역
- **[[Heap 메모리]]** - 인스턴스가 저장되는 메모리 영역
- **[[가비지 컬렉션 (Garbage Collection)|가비지 컬렉션]]** - 인스턴스의 메모리 관리
- **[[객체]]** - 객체와 인스턴스의 관계

---

**태그:** #java #인스턴스 #변수 #참조변수 #객체 #면접 #개념정리

